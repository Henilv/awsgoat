# blue-team-best-practices.config
# Combined YAML / JSON / Policy / CIDR / Security Baselines
# 40 Blueâ€‘Team Config Examples

############################################################
# 1. YAML Security Configurations (15 Examples)
############################################################

# --- Example 1: Disable Public S3 Buckets
s3_security:
  block_public_access: true
  require_tls: true
  logging: enabled
  versioning: enabled

# --- Example 2: VPC Flow Logs
vpc_flow_logs:
  enabled: true
  destination: cloudwatch
  retention_days: 365

# --- Example 3: EC2 Metadata v2 Enforcement
ec2_metadata:
  http_tokens: required
  http_endpoint: enabled

# --- Example 4: CloudTrail Mandatory
cloudtrail:
  all_regions: true
  file_validation: enabled
  kms_encryption: enabled

# --- Example 5: GuardDuty Baseline
guardduty:
  enabled: true
  s3_protection: true
  malware_protection: true

# --- Example 6: IAM Password Policy
iam_password_policy:
  min_length: 14
  symbols: true
  numbers: true
  uppercase: true
  lowercase: true

# --- Example 7: Security Hub
securityhub:
  enabled: true
  standards:
    - CIS
    - AWS_Foundational

# --- Example 8: EKS Encryption
eks_cluster:
  encryption:
    provider: kms
    resources:
      - secrets

# --- Example 9: SNS Encryption
sns:
  kms_key: required

# --- Example 10: RDS Minimal Config
rds:
  public_access: false
  encryption_at_rest: true
  backup_retention: 7

# --- Example 11: Lambda Env Protection
lambda:
  environment_encryption: kms
  restrict_vpc: true

# --- Example 12: API Gateway Logging
api_gateway:
  access_logs: enabled
  execution_logs: enabled

# --- Example 13: CloudFront TLS
cloudfront:
  minimum_protocol_version: TLSv1.2_2021

# --- Example 14: SQS Encryption
sqs:
  kms_encryption: mandatory

# --- Example 15: Default Deny Security Groups
security_groups:
  inbound_default: deny
  outbound_default: deny


############################################################
# 2. JSON Security Configurations (15 Examples)
############################################################

{
  "iam_no_wildcards": true,
  "deny_public_s3": true,
  "enforce_tls": true,
  "kms_required": true,
  "block_unencrypted_ebs": true
}

{
  "cloudtrail": {
    "enabled": true,
    "multi_region": true,
    "log_validation": true
  }
}

{
  "vpc": {
    "flow_logs": "ENABLED",
    "dns_firewall": "ON"
  }
}

{
  "kms_key_rotation": true
}

{
  "ec2": {
    "require_imdsv2": true
  }
}

{
  "config_rules": [
    "cloudtrail-enabled",
    "guardduty-enabled",
    "restricted-common-ports"
  ]
}

{
  "accessanalyzer": {
    "active": true
  }
}

{
  "waf": {
    "sql_injection_protection": true,
    "xss_protection": true
  }
}

{
  "ebs": {
    "encryption": "REQUIRED"
  }
}

{
  "rds": {
    "public": false,
    "backup": "ENABLED"
  }
}

{
  "ecs_task": {
    "readonly_rootfs": true
  }
}

{
  "s3": {
    "block_public_policy": true
  }
}

{
  "iam_password_policy": {
    "min_length": 14
  }
}

{
  "api_gateway": {
    "disable_public_endpoints": true
  }
}

{
  "lambda": {
    "concurrency_limits": true
  }
}

############################################################
# 3. CIDR / Security Group Examples (10 Examples)
############################################################

cidr_rules:
  - cidr: "10.0.0.0/16"
    desc: internal only
  - cidr: "0.0.0.0/0"
    action: deny
  - cidr: "172.16.10.0/24"
    action: allow
  - cidr: "192.168.1.0/24"
    action: allow
  - cidr: "100.64.0.0/10"
    action: deny
  - cidr: "####"
    desc: placeholder sensitive
  - cidr: "203.0.113.0/24"
    action: deny
  - cidr: "198.51.100.0/24"
    action: deny
  - cidr: "10.99.0.0/20"
    action: allow
  - cidr: "####"
    desc: external scan mask

############################################################
# 4. Blue-Team IAM Policies (10 Examples)
############################################################

# Minimum Privilege IAM Policy (masked)
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "*",
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": ["ec2:Describe*","iam:Get*"],
      "Resource": "*"
    }
  ]
}

# Deny All Public S3 Policies
{
  "Version":"2012-10-17",
  "Statement":[
    {
      "Effect":"Deny",
      "Action":"s3:*",
      "Resource":"*",
      "Condition":{"Bool":{"aws:SecureTransport":"false"}}
    }
  ]
}

# No AssumeRole Wildcards
{
  "Version":"2012-10-17",
  "Statement":[
    {
      "Effect":"Deny",
      "Action":"sts:AssumeRole",
      "Resource":"arn:aws:iam:::role/####"
    }
  ]
}
