
# --------------------------
# 1. IAM Policies (Least Privilege)
# --------------------------
iam_policy_1:
  Version: "2012-10-17"
  Statement:
    - Effect: Allow
      Action: ["lambda:InvokeFunction"]
      Resource: "arn:aws:lambda:####"
iam_policy_2:
  Version: "2012-10-17"
  Statement:
    - Effect: Deny
      Action: "*"
      Resource: "*"
      Condition:
        StringLike:
          aws:RequestedRegion: "us-east-1"

# --------------------------
# 2. Security Groups (Restricted)
# --------------------------
sg_https_only:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: "HTTPS-only SG"
    VpcId: vpc-####
    SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 443
        ToPort: 443
        CidrIp: 10.0.0.0/24
    SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: 0.0.0.0/0

sg_deny_ssh:
  Type: AWS::EC2::SecurityGroup
  Properties:
    SecurityGroupIngress: []

# --------------------------
# 3. S3 Bucket Configs
# --------------------------
s3_block_public:
  BucketName: ####
  PublicAccessBlockConfiguration:
    BlockPublicPolicy: true
    BlockPublicAcls: true
s3_encryption:
  BucketName: ####
  ServerSideEncryptionConfiguration:
    - ServerSideEncryptionByDefault:
        SSEAlgorithm: aws:kms
        KMSMasterKeyID: ####

# --------------------------
# 4. VPC and Subnets
# --------------------------
vpc_config:
  VpcCidr: 10.0.0.0/16
  Subnets:
    PublicSubnet: 10.0.1.0/24
    PrivateAppSubnet: 10.0.2.0/24
    DatabaseSubnet: 10.0.3.0/24

# --------------------------
# 5. CloudTrail and CloudWatch
# --------------------------
cloudtrail_config:
  IsMultiRegionTrail: true
  IncludeGlobalServiceEvents: true
  EnableLogFileValidation: true

cloudwatch_retention:
  LogGroupName: ####
  RetentionInDays: 30

# --------------------------
# 6. Lambda / API Gateway / Cognito
# --------------------------
lambda_private_subnet:
  VpcConfig:
    SubnetIds: [subnet-private-1]
    SecurityGroupIds: [sg-####]

api_gateway:
  TracingEnabled: true
  MinimumCompressionSize: 0
  AuthorizationType: COGNITO_USER_POOLS

cognito_mfa:
  UserPoolName: ####
  MfaConfiguration: ON
  PasswordPolicy:
    MinimumLength: 12
    RequireSymbols: true

# --------------------------
# 7. RDS / DynamoDB / EBS
# --------------------------
rds_secure:
  PubliclyAccessible: false
  StorageEncrypted: true

dynamodb_secure:
  PointInTimeRecoverySpecification:
    PointInTimeRecoveryEnabled: true

ebs_secure:
  Encrypted: true
  KmsKeyId: ####

# --------------------------
# 8. KMS / GuardDuty / SecurityHub
# --------------------------
kms_key_rotation:
  EnableKeyRotation: true

guardduty_enable:
  Enable: true

securityhub_enable:
  StandardsSubscription: ["arn:aws:securityhub:::standard/cis-aws-foundations-benchmark/v/1.2.0"]

# --------------------------
# 9. WAF / Route53 / VPC Endpoints
# --------------------------
waf_sql_protection:
  Rules:
    - Name: SQLiProtection
      Statement:
        SqliMatchStatement:
          FieldToMatch:
            Body: {}

route53_dnssec:
  Signing: ENABLED

vpc_endpoint_s3:
  ServiceName: com.amazonaws.us-east-1.s3
  VpcEndpointType: Gateway

# --------------------------
# 10. Best Practices Summary
# --------------------------
best_practices:
  IAM: ["Least privilege", "No wildcards", "MFA enforced", "Rotate keys"]
  Network: ["No 0.0.0.0/0 SSH", "Private subnets for workloads", "Restrict egress"]
  S3: ["Block public access", "Enable encryption", "Enable versioning"]
  Logging: ["CloudTrail enabled", "CloudWatch logs retention", "GuardDuty", "SecurityHub"]
  Deployment: ["Scan templates pre-deploy", "Block wildcard IAM", "Monitor SGs", "Scan Lambda layers for secrets"]

# --------------------------
# End of aws_blue_team.config
# --------------------------
